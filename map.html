<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>9x9 Precision Grid | GardenHub</title>
    <style>
        :root { 
            --leaf: #4f772d; --dark: #31572c; --dirt: #604d3f; 
            --grass: #aacc00; --wood: #bc8a5f; --seed: #e9c46a;
        }
        
        body { font-family: 'Segoe UI', sans-serif; background: #e9edc9; margin: 0; display: flex; height: 100vh; overflow: hidden; }

        #sidebar {
            width: 240px; background: white; padding: 20px;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1); display: flex; flex-direction: column;
            z-index: 10;
        }
        .seed-card {
            background: var(--seed); padding: 10px; border-radius: 8px;
            margin-bottom: 8px; cursor: grab; font-weight: bold;
            display: flex; justify-content: space-between; align-items: center;
            border: 2px solid transparent; transition: 0.2s;
        }
        .seed-card:hover { border-color: var(--leaf); transform: translateX(5px); }
        .qty-tag { font-size: 0.7rem; background: rgba(0,0,0,0.1); padding: 2px 6px; border-radius: 4px; }

        .main-view { flex-grow: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
        
        .grid-container {
            display: grid;
            grid-template-columns: repeat(9, 60px); 
            grid-template-rows: repeat(9, 60px);    
            gap: 4px;
            background: var(--wood);
            padding: 12px;
            border-radius: 10px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }

        .grid-spot {
            width: 60px; height: 60px;
            background: var(--dirt);
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; transition: 0.2s;
            border-radius: 4px; position: relative;
        }

        .grid-spot.occupied { background: #556b2f; }
        
        /* The Spacing Multiplier Badge */
        .multiplier-badge {
            position: absolute; bottom: 2px; right: 2px;
            background: var(--leaf); color: white;
            font-size: 0.6rem; padding: 1px 4px; border-radius: 3px;
            font-weight: bold;
        }

        .grid-spot.occupied:hover::after {
            content: "‚úï"; position: absolute; font-size: 1.2rem; color: white;
            background: rgba(211, 47, 47, 0.8); width: 100%; height: 100%;
            display: flex; align-items: center; justify-content: center; border-radius: 4px;
        }

        .btn-clear { background: #e76f51; color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: bold; width: 100%; margin-top: auto; }
    </style>
</head>
<body>

<div id="sidebar">
    <h3 style="color:var(--dark); margin-top:0;">üß∫ Square Foot Library</h3>
    
    <div class="seed-card" draggable="true" ondragstart="drag(event)" data-emoji="üçÖ" data-name="Tomato" data-qty="1">
        <span>üçÖ Tomato</span> <span class="qty-tag">1/sq</span>
    </div>
    <div class="seed-card" draggable="true" ondragstart="drag(event)" data-emoji="ü•¨" data-name="Lettuce" data-qty="4">
        <span>ü•¨ Lettuce</span> <span class="qty-tag">4/sq</span>
    </div>
    <div class="seed-card" draggable="true" ondragstart="drag(event)" data-emoji="ü•ï" data-name="Carrot" data-qty="16">
        <span>ü•ï Carrot</span> <span class="qty-tag">16/sq</span>
    </div>
    <div class="seed-card" draggable="true" ondragstart="drag(event)" data-emoji="üßÖ" data-name="Onion" data-qty="9">
        <span>üßÖ Onion</span> <span class="qty-tag">9/sq</span>
    </div>
    <div class="seed-card" draggable="true" ondragstart="drag(event)" data-emoji="üå∂Ô∏è" data-name="Pepper" data-qty="1">
        <span>üå∂Ô∏è Pepper</span> <span class="qty-tag">1/sq</span>
    </div>
    <div class="seed-card" draggable="true" ondragstart="drag(event)" data-emoji="üåø" data-name="Basil" data-qty="4">
        <span>üåø Basil</span> <span class="qty-tag">4/sq</span>
    </div>

    <button class="btn-clear" onclick="clearFullGrid()">Reset All</button>
    <a href="index.html" style="display:block; text-align:center; margin-top:15px; color:var(--leaf); text-decoration:none; font-weight:bold;">‚Üê Dashboard</a>
</div>

<div class="main-view">
    <div style="text-align:center; margin-bottom: 15px;">
        <h2 style="margin:0;">9x9 SFG Planner</h2>
        <p style="margin:0; font-size:0.9rem;">Hover over a square to see the plant count</p>
    </div>
    <div class="grid-container" id="gardenGrid"></div>
</div>

<script>
    const GRID_SIZE = 81; 
    const gridContainer = document.getElementById('gardenGrid');

    function initGrid() {
        const savedLayout = JSON.parse(localStorage.getItem('gardenGridLayout')) || {};
        gridContainer.innerHTML = ""; 
        
        for (let i = 0; i < GRID_SIZE; i++) {
            const spot = document.createElement('div');
            spot.classList.add('grid-spot');
            spot.id = `spot-${i}`;
            spot.ondragover = (e) => e.preventDefault();
            spot.ondrop = (e) => handleDrop(e, i);
            spot.onclick = () => removePlant(i);
            
            if (savedLayout[i]) {
                const data = savedLayout[i];
                spot.innerHTML = `<span style="font-size:1.8rem;">${data.emoji}</span>`;
                spot.classList.add('occupied');
                
                // Add the multiplier badge if more than 1
                if(data.qty > 1) {
                    const badge = document.createElement('div');
                    badge.className = 'multiplier-badge';
                    badge.innerText = `x${data.qty}`;
                    spot.appendChild(badge);
                }
            }
            gridContainer.appendChild(spot);
        }
    }

    function drag(ev) {
        ev.dataTransfer.setData("emoji", ev.target.getAttribute('data-emoji'));
        ev.dataTransfer.setData("name", ev.target.getAttribute('data-name'));
        ev.dataTransfer.setData("qty", ev.target.getAttribute('data-qty'));
    }

    function handleDrop(ev, index) {
        ev.preventDefault();
        const emoji = ev.dataTransfer.getData("emoji");
        const name = ev.dataTransfer.getData("name");
        const qty = ev.dataTransfer.getData("qty");
        
        if(!emoji) return;

        let savedLayout = JSON.parse(localStorage.getItem('gardenGridLayout')) || {};
        savedLayout[index] = { emoji, name, qty };
        localStorage.setItem('gardenGridLayout', JSON.stringify(savedLayout));
        initGrid(); 
    }

    function removePlant(index) {
        let savedLayout = JSON.parse(localStorage.getItem('gardenGridLayout')) || {};
        if (savedLayout[index]) {
            delete savedLayout[index];
            localStorage.setItem('gardenGridLayout', JSON.stringify(savedLayout));
            initGrid(); 
        }
    }

    function clearFullGrid() {
        if (confirm("Reset the garden?")) {
            localStorage.removeItem('gardenGridLayout');
            initGrid();
        }
    }

    window.onload = initGrid;
</script>
</body>
</html>
