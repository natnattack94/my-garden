<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GardenHub OS | Spatial Studio v10.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { background-color: #0f172a; font-family: 'Inter', sans-serif; overflow: hidden; color: white; }
        
        /* Grid System */
        #viewport { 
            background-color: #0f172a; position: relative; width: 1000px; height: 1000px;
            display: grid; grid-template-columns: repeat(20, 50px); grid-template-rows: repeat(20, 50px);
            gap: 2px; padding: 10px; border: 2px solid rgba(255,255,255,0.05);
        }
        .grid-cell { width: 50px; height: 50px; background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.05); transition: all 0.2s ease; }
        .grid-cell:hover { background: rgba(255,255,255,0.08); }
        
        /* Tactical Layers */
        .tag-frost { background: rgba(99, 102, 241, 0.4) !important; border-color: #6366f1 !important; }
        .tag-wet { background: rgba(6, 182, 212, 0.4) !important; border-color: #06b6d4 !important; }
        
        /* Assets */
        .bed-obj { 
            position: absolute; cursor: move; display: flex; align-items: center; justify-content: center;
            font-size: 9px; font-weight: 900; text-transform: uppercase; border-radius: 8px; z-index: 10;
            box-shadow: 0 10px 20px rgba(0,0,0,0.5);
        }
        .type-raised { background: #92400e; border: 2px solid #78350f; color: #fef3c7; }
        .type-wall { background: #334155; border: 2px solid #475569; color: #f1f5f9; }
        
        .plant-obj {
            position: absolute; cursor: pointer; width: 40px; height: 40px;
            display: flex; align-items: center; justify-content: center;
            font-size: 22px; border-radius: 50%; z-index: 60; transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .stage-bloom { box-shadow: 0 0 15px #ec4899; border: 2px solid #ec4899; }

        /* UI Components */
        .glass-panel { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 16px; }
        .active-btn { background: #3b82f6 !important; color: white !important; box-shadow: 0 0 15px rgba(59, 130, 246, 0.5); }
        .timeline-track { background: rgba(255,255,255,0.05); height: 4px; border-radius: 2px; position: relative; }
        .timeline-fill { height: 100%; background: #3b82f6; border-radius: 2px; }
        
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
    </style>
</head>
<body class="flex h-screen">

    <aside class="w-[360px] bg-slate-900/90 backdrop-blur-xl border-r border-white/10 p-6 flex flex-col gap-5 overflow-y-auto z-[100]">
        <div class="flex justify-between items-start">
            <div>
                <h2 class="text-[10px] font-black text-blue-400 uppercase tracking-widest">Temporal IQ v10.0</h2>
                <p class="text-2xl font-black text-white uppercase tracking-tighter leading-none">Spatial Studio</p>
            </div>
            <div class="text-right">
                <span class="text-[9px] font-bold text-slate-500 uppercase">Opt. Score</span>
                <p class="text-xl font-black text-green-400">100%</p>
            </div>
        </div>

        <div class="glass-panel p-4">
            <div class="flex justify-between items-center mb-3">
                <h3 class="text-[9px] font-bold text-slate-400 uppercase">Care Calendar</h3>
                <span class="text-[8px] bg-blue-500/20 text-blue-400 px-2 py-0.5 rounded-full font-bold uppercase">Hartford Live</span>
            </div>
            <div id="growth-feed" class="space-y-3 max-h-48 overflow-y-auto pr-2">
                </div>
        </div>

        <div class="glass-panel p-4">
            <h3 class="text-[9px] font-bold text-slate-400 uppercase mb-3">Crop Rotation & Soil</h3>
            <div class="flex gap-2 mb-3">
                <button class="flex-1 py-1 bg-amber-600/20 text-amber-500 rounded-lg text-[10px] font-black border border-amber-600/30">2026</button>
                <button class="flex-1 py-1 bg-white/5 text-slate-500 rounded-lg text-[10px] font-black border border-white/5">2027</button>
            </div>
            <div class="flex justify-between items-center">
                <span class="text-[10px] font-bold text-slate-300">NITROGEN HEALTH</span>
                <span class="text-[10px] font-black text-green-400 uppercase tracking-widest">Optimal</span>
            </div>
        </div>

        <div>
            <p class="text-[9px] font-bold text-slate-500 uppercase mb-2">Inventory</p>
            <div class="grid grid-cols-2 gap-2 mb-4">
                <div class="p-3 bg-white/5 border border-white/10 rounded-xl cursor-grab text-[10px] font-bold flex items-center gap-2" draggable="true" ondragstart="startBedDrag(event, 'raised', 150, 100)">üü´ Raised Bed</div>
                <div class="p-3 bg-white/5 border border-white/10 rounded-xl cursor-grab text-[10px] font-bold flex items-center gap-2" draggable="true" ondragstart="startBedDrag(event, 'wall', 200, 20)">üß± Heat-Wall</div>
            </div>
            <div class="grid grid-cols-2 gap-2">
                <div class="p-3 bg-white/5 border border-white/10 rounded-xl cursor-grab text-[10px] font-bold flex items-center gap-2" draggable="true" ondragstart="startPlantDrag(event, 'Tomato', 'üçÖ', 24, 75, 140)">üçÖ Tomato</div>
                <div class="p-3 bg-white/5 border border-white/10 rounded-xl cursor-grab text-[10px] font-bold flex items-center gap-2" draggable="true" ondragstart="startPlantDrag(event, 'Zinnia', 'üå∏', 12, 60, 130)">üå∏ Zinnia</div>
            </div>
        </div>

        <div class="mt-auto border-t border-white/10 pt-4 space-y-4">
            <div>
                <h3 class="text-[9px] font-bold text-amber-500 uppercase mb-2 tracking-widest">Heliophysics</h3>
                <div class="flex gap-1">
                    <button class="flex-1 py-1.5 bg-white/5 text-[9px] font-black rounded-md uppercase">Spring</button>
                    <button class="flex-1 py-1.5 bg-amber-600 text-white text-[9px] font-black rounded-md uppercase shadow-lg shadow-amber-600/20">Summer</button>
                    <button class="flex-1 py-1.5 bg-white/5 text-[9px] font-black rounded-md uppercase">Fall</button>
                </div>
            </div>
            
            <div class="grid grid-cols-2 gap-2">
                <button onclick="setTacticalMode('frost')" id="btn-frost" class="py-3 bg-slate-800 border border-white/10 rounded-xl text-[9px] font-black uppercase tracking-tighter hover:border-indigo-500 transition">‚ùÑÔ∏è Frost Paint</button>
                <button onclick="setTacticalMode('wet')" id="btn-wet" class="py-3 bg-slate-800 border border-white/10 rounded-xl text-[9px] font-black uppercase tracking-tighter hover:border-cyan-500 transition">üíß Wet Paint</button>
            </div>

            <div id="trash-bin" ondragover="event.preventDefault()" ondrop="deleteItem(event)" class="py-3 border-2 border-dashed border-red-900/30 rounded-xl text-[8px] font-bold text-red-500/50 text-center uppercase">üóëÔ∏è Drop to Delete</div>
        </div>
    </aside>

    <main class="flex-grow overflow-auto bg-slate-950 p-20 flex items-center justify-center relative">
        <div id="viewport" ondragover="event.preventDefault()" ondrop="handleDrop(event)"></div>

        <div class="absolute bottom-10 left-1/2 -translate-x-1/2 w-[700px] bg-slate-900/90 border border-white/10 p-6 rounded-3xl backdrop-blur-xl z-[200] shadow-2xl">
            <div class="flex justify-between text-[10px] font-black text-slate-500 uppercase mb-3 tracking-tighter">
                <span>Mar</span><span>Apr</span><span>May</span><span class="text-blue-400">Jun</span><span class="text-pink-500">Jul</span><span>Aug</span><span>Sep</span><span>Oct</span>
            </div>
            <input type="range" min="60" max="300" step="1" value="165" id="time-scrubber" oninput="renderAll()" class="w-full accent-pink-500 bg-slate-700 h-2 rounded-lg appearance-none cursor-pointer">
            <p class="text-center text-[9px] font-bold text-slate-400 mt-3 uppercase tracking-[0.3em]">Biological "Season Pulse" Controller ‚Äî <span id="pulse-date" class="text-white">Jun 15</span></p>
        </div>
    </main>

<script>
    let bedData = [], plantData = [], activeTacticalTool = null;

    function createGrid() {
        const vp = document.getElementById('viewport');
        for (let i = 0; i < 400; i++) {
            const cell = document.createElement('div');
            cell.className = 'grid-cell';
            cell.id = `cell-${i}`;
            cell.onclick = () => applyTactical(i);
            vp.appendChild(cell);
        }
    }

    function startBedDrag(e, type, w, h) {
        e.dataTransfer.setData("itemType", "bed"); e.dataTransfer.setData("type", type);
        e.dataTransfer.setData("w", w); e.dataTransfer.setData("h", h); e.dataTransfer.setData("isNew", "true");
    }

    function startPlantDrag(e, name, icon, spread, dtm, bloomStart) {
        e.dataTransfer.setData("itemType", "plant"); e.dataTransfer.setData("name", name);
        e.dataTransfer.setData("icon", icon); e.dataTransfer.setData("spread", spread);
        e.dataTransfer.setData("dtm", dtm); e.dataTransfer.setData("bloomStart", bloomStart);
        e.dataTransfer.setData("isNew", "true");
    }

    function handleDrop(e) {
        const rect = document.getElementById('viewport').getBoundingClientRect();
        const x = e.clientX - rect.left, y = e.clientY - rect.top;
        const itemType = e.dataTransfer.getData("itemType");
        const isNew = e.dataTransfer.getData("isNew") === "true";

        if (itemType === "bed") {
            if (isNew) {
                const w = parseInt(e.dataTransfer.getData("w")), h = parseInt(e.dataTransfer.getData("h"));
                bedData.push({ id: Date.now(), type: e.dataTransfer.getData("type"), x: x-(w/2), y: y-(h/2), w, h });
            } else {
                const id = parseInt(e.dataTransfer.getData("id")), bed = bedData.find(b => b.id === id);
                if (bed) { bed.x = x-(bed.w/2); bed.y = y-(bed.h/2); }
            }
        } else if (itemType === "plant") {
            if (isNew) {
                plantData.push({ 
                    id: Date.now(), name: e.dataTransfer.getData("name"), 
                    icon: e.dataTransfer.getData("icon"), dtm: parseInt(e.dataTransfer.getData("dtm")),
                    bloomStart: parseInt(e.dataTransfer.getData("bloomStart")), x, y 
                });
            } else {
                const id = parseInt(e.dataTransfer.getData("id")), plant = plantData.find(p => p.id === id);
                if (plant) { plant.x = x; plant.y = y; }
            }
        }
        renderAll();
    }

    function setTacticalMode(m) { 
        activeTacticalTool = activeTacticalTool === m ? null : m; 
        document.getElementById('btn-frost').classList.toggle('active-btn', activeTacticalTool === 'frost');
        document.getElementById('btn-wet').classList.toggle('active-btn', activeTacticalTool === 'wet');
    }

    function applyTactical(id) { 
        if (activeTacticalTool) document.getElementById(`cell-${id}`).classList.toggle(`tag-${activeTacticalTool}`); 
    }

    function renderAll() {
        document.querySelectorAll('.bed-obj, .plant-obj').forEach(el => el.remove());
        const feed = document.getElementById('growth-feed');
        feed.innerHTML = '';
        
        const simDay = parseInt(document.getElementById('time-scrubber').value);
        const date = new Date(2026, 0); date.setDate(simDay);
        document.getElementById('pulse-date').innerText = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });

        bedData.forEach(bed => {
            const el = document.createElement('div'); el.className = `bed-obj type-${bed.type}`;
            el.style.cssText = `left:${bed.x}px;top:${bed.y}px;width:${bed.w}px;height:${bed.h}px;`;
            el.innerText = bed.type; el.draggable = true;
            el.ondragstart = (e) => { e.dataTransfer.setData("itemType", "bed"); e.dataTransfer.setData("id", bed.id); e.dataTransfer.setData("isNew", "false"); };
            document.getElementById('viewport').appendChild(el);
        });

        plantData.forEach(p => {
            const plantingDay = 120; // May 1st
            const age = simDay - plantingDay;
            const growthScale = Math.max(0, Math.min(1, age / p.dtm));
            const isBlooming = simDay >= p.bloomStart && simDay <= (p.bloomStart + 40);

            const el = document.createElement('div'); 
            el.className = `plant-obj ${isBlooming ? 'stage-bloom' : ''}`;
            el.style.cssText = `left:${p.x-20}px;top:${p.y-20}px; transform: scale(${0.3 + (growthScale * 0.7)}); opacity: ${age < -5 ? 0 : 1}`;
            el.innerText = p.icon; el.draggable = true;
            el.ondragstart = (e) => { e.dataTransfer.setData("itemType", "plant"); e.dataTransfer.setData("id", p.id); e.dataTransfer.setData("isNew", "false"); };
            document.getElementById('viewport').appendChild(el);

            const progress = Math.round(growthScale * 100);
            feed.innerHTML += `
                <div class="text-[10px]">
                    <div class="flex justify-between font-bold uppercase mb-1">
                        <span>${p.icon} ${p.name}</span>
                        <span class="${isBlooming ? 'text-pink-500' : 'text-slate-500'}">${isBlooming ? 'BLOOMING' : progress + '%'}</span>
                    </div>
                    <div class="timeline-track"><div class="timeline-fill" style="width:${progress}%; background:${isBlooming ? '#ec4899' : '#3b82f6'}"></div></div>
                </div>`;
        });
    }

    function deleteItem(e) { 
        const id = parseInt(e.dataTransfer.getData("id")), type = e.dataTransfer.getData("itemType");
        if (type === "bed") bedData = bedData.filter(b => b.id !== id);
        else plantData = plantData.filter(p => p.id !== id);
        renderAll();
    }

    window.onload = () => { createGrid(); renderAll(); };
</script>
</body>
</html>
